<div class="body-padding">
<header>
    <div *ngIf="customer">
        <h1>
            {{customer.firstName}}'s order history <br>
        </h1>
        <h3>
            customer id: {{customer.customerId}}
        </h3>
    </div>
</header>
<mat-progress-bar mode="indeterminate" *ngIf="showSpinner"></mat-progress-bar>
<div *ngIf="loadFailed">
    <h2>
        Loading Timeout. Please try again later.
    </h2>
</div>

<div>
    <table *ngIf="orderArray" mat-table [dataSource]="orderArray" class="mat-elevation-z8">
        <ng-container matColumnDef="orderId">
            <th mat-header-cell *matHeaderCellDef> Order ID </th>
            <td mat-cell *matCellDef="let order"> {{order.orderId}} </td>
        </ng-container>

        <ng-container matColumnDef="tourId">
            <th mat-header-cell *matHeaderCellDef> Tour ID </th>
            <td mat-cell *matCellDef="let order"> {{order.tourId}} </td>
        </ng-container>

        <ng-container matColumnDef="salesId">
            <th mat-header-cell *matHeaderCellDef> Sales ID </th>
            <td mat-cell *matCellDef="let order"> {{order.salesId}} </td>
        </ng-container>  
        
        <ng-container matColumnDef="referral">
            <th mat-header-cell *matHeaderCellDef> Referral </th>
            <td mat-cell *matCellDef="let order"> {{order.referral}} </td>
        </ng-container>

        <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> Status </th>
            <td mat-cell *matCellDef="let order">
                <p *ngIf="order.isCompleted" class="completed">completed<p>
                <p *ngIf="!order.isCompleted">awaiting payment</p>
            </td>
        </ng-container>

        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let customer">
                <button mat-button [matMenuTriggerFor]="beforeMenu">actions</button>
                <mat-menu #beforeMenu="matMenu" xPosition="before">
                    <button mat-menu-item (click)="updateStatus(customer.customerId)">update status</button>
                    <button mat-menu-item (click)="updatePaymentStatus(customer.customerId)">updated payment status</button>
                    <button mat-menu-item (click)="uploadDocs(customer.customerId)">upload documents</button>
                </mat-menu>
            </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
</div>
</div> 